echo "🔍 运行推送前检查..."

# 检查是否有未提交的更改
if ! git diff-index --quiet HEAD --; then
    echo "❌ 存在未提交的更改，请先提交所有更改后再推送"
    exit 1
fi

# 运行类型检查
echo "📝 运行 TypeScript 类型检查..."
npm run type-check
if [ $? -ne 0 ]; then
    echo "❌ TypeScript 类型检查失败"
    exit 1
fi

# 运行 Rust 代码检查
echo "🦀 运行 Rust 代码检查..."
npm run clippy
if [ $? -ne 0 ]; then
    echo "❌ Rust Clippy 检查失败"
    exit 1
fi

echo "✅ 所有检查通过，可以推送"